// AI拍摄建议生成器
const AdviceGenerator = {
  // 获取建议
  getAdvice(category, style) {
    const composition = this.getCompositionAdvice(category, style);
    const lighting = this.getLightingAdvice(category, style);
    const angle = this.getAngleAdvice(category, style);
    
    return { composition, lighting, angle };
  },
  
  // 构图建议
  getCompositionAdvice(category, style) {
    const adviceMap = {
      '人像': {
        '日系': '将人物放在画面左侧或右侧三分之一处，眼睛位于上方黄金分割线附近，留出呼吸空间，营造自然舒适的视觉感受。',
        '港风': '采用中心构图突出人物气场，或使用对角线构图增强动感。注意人物视线方向留白，制造故事感。',
        '电影': '使用黄金分割构图，将人物眼睛置于焦点位置。适当留白营造电影画幅感，增强叙事性。',
        '胶片': '略微偏离中心的构图更显自然，利用九宫格交叉点安排主体，模拟胶片摄影的随性感。',
        'default': '将人物主体放在九宫格的交叉点上，利用三分法构图使画面更加平衡。注意人物视线方向的留白空间。'
      },
      '风光摄影': {
        '日系': '使用三分法构图，将地平线放在上方或下方三分之一处。前景、中景、远景层次分明，营造空间感。',
        '大气': '采用对称构图或三角形构图，突出自然的宏伟气势。可使用前景引导线将视线引向远方。',
        '极简': '大量留白配合简洁元素，主体放在画面的黄金分割点上，制造强烈的视觉焦点。',
        'default': '遵循三分法则，将地平线置于画面上三分之一或下三分之一处。利用前景元素增强空间层次。'
      },
      '建筑': {
        '极简': '采用对称构图或中心构图，强调建筑的几何美感。注意垂直线条的平行，避免畸变。',
        '现代': '使用对角线构图增强动感，或通过引导线突出建筑线条。注意画面的简洁性。',
        'default': '注意建筑垂直线条的平直，使用对称构图或三分法构图。可利用建筑自身的线条作为引导线。'
      },
      '美食': {
        '日系': '俯拍45度角，将主食物放在画面左上或右上的黄金分割点，周围适当留白并搭配小道具。',
        '高级': '使用对角线构图或三角形构图，营造层次感。注意餐具与食物的排列关系。',
        'default': '采用俯拍或45度角拍摄，将主体食物放在九宫格交叉点。注意配菜和餐具的搭配，营造层次感。'
      }
    };
    
    return this.findAdvice(adviceMap, category, style);
  },
  
  // 光线建议
  getLightingAdvice(category, style) {
    const adviceMap = {
      '人像': {
        '日系': '选择清晨或傍晚的柔和自然光，避开正午直射光。可使用窗边散射光，营造通透明亮的日系氛围。',
        '港风': '使用侧光或顶光制造光影对比，增强戏剧性。可适当增加暗部阴影，突出港风质感。',
        '电影': '利用侧逆光营造氛围感，注意高光与暗部的层次。可使用轮廓光勾勒人物边缘。',
        'default': '柔和的自然光最为理想，建议选择清晨或傍晚的黄金时段。避免正午的强烈直射光，可利用侧逆光营造层次感。'
      },
      '风光摄影': {
        '日系': '清晨或傍晚的柔光时段最佳，天空呈现梦幻色彩。避免正午平淡的光线。',
        '大气': '利用日出日落的黄金时刻，或雨后云层透光。注意天空与地面的光比平衡。',
        'default': '黄金时段（日出后1小时或日落前1小时）光线最柔和。阴天时光线均匀，适合表现细节和色彩。'
      },
      '建筑': {
        '极简': '选择正午顶光，制造强烈的光影对比。或选择阴天，光线均匀突出建筑线条。',
        '现代': '侧光可以突出建筑的立体感和线条美。注意避免过强的阴影遮挡关键细节。',
        'default': '侧光能够突出建筑的立体感和质感。可选择清晨或傍晚，柔和的光线不会产生过硬的阴影。'
      },
      '美食': {
        '日系': '使用窗边自然散射光，或45度侧光。避免顶光产生的硬阴影，保持画面清新通透。',
        '高级': '侧光或侧逆光突出食物质感和立体感。可适当使用反光板填充阴影。',
        'default': '45度侧光最能表现食物的质感和层次。避免顶光和正面光，适当补光让暗部不会过黑。'
      }
    };
    
    return this.findAdvice(adviceMap, category, style);
  },
  
  // 角度建议
  getAngleAdvice(category, style) {
    const adviceMap = {
      '人像': {
        '日系': '平视或略微俯拍，让人物显得自然亲切。避免过度仰拍或俯拍，保持画面的舒适感。',
        '港风': '可尝试稍低的仰拍角度，突出人物气场。或采用平视制造对视感，增强情绪表达。',
        '电影': '根据情节需要选择角度，平视更显真实，仰拍增强力量感，俯拍营造脆弱感。',
        'default': '平视角度最为自然，可尝试稍低的拍摄角度突出主体立体感。同时注意背景的简洁性，避免杂乱元素。'
      },
      '风光摄影': {
        '日系': '平视或略低角度，保持地平线水平。可寻找有趣的前景元素作为引导。',
        '大气': '可尝试高机位俯拍展现广阔场景，或低机位仰拍突出天空的壮阔。',
        'default': '根据主题选择角度，平视展现真实感受，低角度突出前景，高角度展现全景。保持地平线平直。'
      },
      '建筑': {
        '极简': '正面平拍保持对称，或仰拍突出建筑的纵向延伸感。注意避免畸变，保持线条平直。',
        '现代': '可大胆尝试仰拍或特殊角度，突出建筑的几何美感和现代感。',
        'default': '略微仰视能突出建筑的高耸感，平视则更显真实。注意控制透视，避免过度的畸变。'
      },
      '美食': {
        '日系': '45度斜角最佳，兼顾食物的立体感和画面的丰富性。必要时可使用90度俯拍。',
        '高级': '45度角展现立体感，90度俯拍展现整体摆盘。根据食物特点灵活选择。',
        'default': '45度角拍摄最为常见，既能展现食物的立体感，又能看到摆盘的整体效果。特殊场景可使用90度俯拍。'
      }
    };
    
    return this.findAdvice(adviceMap, category, style);
  },
  
  // 查找匹配的建议
  findAdvice(adviceMap, category, style) {
    // 获取该题材的建议集
    const categoryAdvice = adviceMap[category] || adviceMap['人像'];
    
    // 查找匹配的风格关键词
    const styleKeywords = ['日系', '港风', '电影', '胶片', '大气', '极简', '现代', '高级'];
    for (const keyword of styleKeywords) {
      if (style.includes(keyword) && categoryAdvice[keyword]) {
        return categoryAdvice[keyword];
      }
    }
    
    // 返回默认建议
    return categoryAdvice['default'] || categoryAdvice[Object.keys(categoryAdvice)[0]];
  }
};
