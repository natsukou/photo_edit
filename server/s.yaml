edition: 3.0.0
name: photo-advice-api
access: default

vars:
  region: cn-shanghai

resources:
  photo-advice-function:
    component: fc3
    props:
      region: ${vars.region}
      functionName: photo-advice-api
      description: AI拍照辅助API函数
      runtime: nodejs18
      code: ./
      handler: index.handler
      memorySize: 512
      timeout: 60
      environmentVariables:
        NODE_ENV: production
        DB_HOST: ${env(DB_HOST)}
        DB_PORT: ${env(DB_PORT)}
        DB_USER: ${env(DB_USER)}
        DB_PASSWORD: ${env(DB_PASSWORD)}
        DB_NAME: ${env(DB_NAME)}
        DASHSCOPE_API_KEY: ${env(DASHSCOPE_API_KEY)}
        ALLOWED_ORIGINS: https://modelscope.cn,https://nakia9-photo-advice2.ms.show
      triggers:
        - triggerType: http
          triggerName: httpTrigger
          triggerConfig:
            authType: anonymous
            methods:
              - GET
              - POST
              - PUT
              - DELETE
              - OPTIONS
